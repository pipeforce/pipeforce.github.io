"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[6964],{3905:function(e,t,a){a.d(t,{Zo:function(){return s},kt:function(){return c}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},p=Object.keys(e);for(n=0;n<p.length;n++)a=p[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(n=0;n<p.length;n++)a=p[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),d=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},s=function(e){var t=d(e.components);return n.createElement(o.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,p=e.originalType,o=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=d(a),c=r,y=u["".concat(o,".").concat(c)]||u[c]||m[c]||p;return a?n.createElement(y,l(l({ref:t},s),{},{components:a})):n.createElement(y,l({ref:t},s))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var p=a.length,l=new Array(p);l[0]=u;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var d=2;d<p;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},7763:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return i},contentTitle:function(){return o},metadata:function(){return d},toc:function(){return s},default:function(){return u}});var n=a(7462),r=a(3366),p=(a(7294),a(3905)),l=["components"],i={id:"basics",title:"Property Store",sidebar_label:"Basics",slug:"/propertystore"},o=void 0,d={unversionedId:"guides/propertystore/basics",id:"guides/propertystore/basics",isDocsHomePage:!1,title:"Property Store",description:"What is the Property Store?",source:"@site/docs/guides/propertystore/10_propertystore-basics.md",sourceDirName:"guides/propertystore",slug:"/propertystore",permalink:"/docs/propertystore",editUrl:"https://github.com/pipeforce/pipeforce.github.io/edit/master/docs/guides/propertystore/10_propertystore-basics.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{id:"basics",title:"Property Store",sidebar_label:"Basics",slug:"/propertystore"},sidebar:"tutorialSidebar",previous:{title:"Microservice Messaging",permalink:"/docs/guides/microservices/messaging"},next:{title:"Advanced Querying",permalink:"/docs/guides/propertystore/advanced-querying"}},s=[{value:"What is the Property Store?",id:"what-is-the-property-store",children:[],level:2},{value:"What is a Property?",id:"what-is-a-property",children:[{value:"Property Attributes",id:"property-attributes",children:[],level:3},{value:"Property Key",id:"property-key",children:[],level:3},{value:"Property Key Pattern",id:"property-key-pattern",children:[],level:3},{value:"Property Value and Type",id:"property-value-and-type",children:[],level:3},{value:"Binary Value",id:"binary-value",children:[],level:3}],level:2},{value:"Create a Property",id:"create-a-property",children:[{value:"Property created event",id:"property-created-event",children:[],level:3}],level:2},{value:"Update a Property",id:"update-a-property",children:[{value:"Property changed event",id:"property-changed-event",children:[],level:3},{value:"Property moved event",id:"property-moved-event",children:[],level:3}],level:2},{value:"Delete a Property",id:"delete-a-property",children:[{value:"Property deleted event",id:"property-deleted-event",children:[],level:3}],level:2},{value:"Loading Properties",id:"loading-properties",children:[{value:"Listing properties",id:"listing-properties",children:[],level:3},{value:"Getting property value",id:"getting-property-value",children:[],level:3},{value:"Advanced Querying",id:"advanced-querying",children:[],level:3}],level:2}],m={toc:s};function u(e){var t=e.components,a=(0,r.Z)(e,l);return(0,p.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,p.kt)("h2",{id:"what-is-the-property-store"},"What is the Property Store?"),(0,p.kt)("p",null,"The property store is the core database in PIPEFORCE to save all your application data. You can create, update, query and delete data on the property store using the  ",(0,p.kt)("a",{parentName:"p",href:"../../../api/commands#property-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.*"))," commands. "),(0,p.kt)("h2",{id:"what-is-a-property"},"What is a Property?"),(0,p.kt)("p",null,"Each data (for example plain text, JSON, binary data, ...) stored in the property store is wrapped into an envelope called a ",(0,p.kt)("strong",{parentName:"p"},"property"),". "),(0,p.kt)("h3",{id:"property-attributes"},"Property Attributes"),(0,p.kt)("p",null,"Each property has multiple attributes (the envelope data). The most important ones are:"),(0,p.kt)("table",null,(0,p.kt)("thead",{parentName:"table"},(0,p.kt)("tr",{parentName:"thead"},(0,p.kt)("th",{parentName:"tr",align:null},"Attribute"),(0,p.kt)("th",{parentName:"tr",align:null},"Description"))),(0,p.kt)("tbody",{parentName:"table"},(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"key")),(0,p.kt)("td",{parentName:"tr",align:null},"The unique, absolute key path of the property. This value can change over time, for example, if a property was moved to another virtual location. ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},"/pipeforce/enterprise/global/app/myapp/data/hello"))),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"uuid")),(0,p.kt)("td",{parentName:"tr",align:null},"A unqiue identificator of the property. Differently to ",(0,p.kt)("inlineCode",{parentName:"td"},"key"),", once created, this ",(0,p.kt)("strong",{parentName:"td"},"will never change"),".  ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},"333a38e7-9188-4135-b87b-3d890f676445"))),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"value")),(0,p.kt)("td",{parentName:"tr",align:null},"This attribute contains the payload of the property as string. ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},'{\\"hello\\": \\"world\\"}'))),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"type")),(0,p.kt)("td",{parentName:"tr",align:null},"This attribute contains the mime type of the value. If this attribute is ",(0,p.kt)("inlineCode",{parentName:"td"},"null"),", it is expected that the mime type of the value is of the default type: ",(0,p.kt)("inlineCode",{parentName:"td"},"text/plain"),". ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},"application/json"))),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"created")),(0,p.kt)("td",{parentName:"tr",align:null},"A unix epoch timestamp in millis when this property was created. ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},"1613397114448"))),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"updated")),(0,p.kt)("td",{parentName:"tr",align:null},"A unix epoch timestamp in millis when this property was updated last or ",(0,p.kt)("inlineCode",{parentName:"td"},"null")," in case it was never updated after creation. ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},"null"))),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"timeToLive")),(0,p.kt)("td",{parentName:"tr",align:null},"The time to live (ttl) in minutes of this property since creation. If the time to live has been expired, the property is eligable to be deleted. Usually one of the next cleanup jobs will then delete this property. There is no guarantee that the property is deleted exactly after this time has expired. If the value of ",(0,p.kt)("strong",{parentName:"td"},"timeToLive")," is ",(0,p.kt)("inlineCode",{parentName:"td"},"0")," or ",(0,p.kt)("inlineCode",{parentName:"td"},"null")," (default), the property will never be deleted. ",(0,p.kt)("br",null),(0,p.kt)("br",null),"Example value: ",(0,p.kt)("inlineCode",{parentName:"td"},"5"))))),(0,p.kt)("h3",{id:"property-key"},"Property Key"),(0,p.kt)("p",null,"Every property has a unique ",(0,p.kt)("strong",{parentName:"p"},"key"),". Such a property key is structured in an ",(0,p.kt)("strong",{parentName:"p"},"hierarchical way")," and has this base structure:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"/pipeforce/<namespace>/<localPath>\n")),(0,p.kt)("p",null,"For example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"/pipeforce/mynamespace/global/app/myapp/config/app\n")),(0,p.kt)("p",null,"Every property belongs to a certain namespace. If such a key starts with a slash ",(0,p.kt)("inlineCode",{parentName:"p"},"/")," at the beginning, it is interpreted as absolute. Meaning, it must start with ",(0,p.kt)("inlineCode",{parentName:"p"},"/pipeforce")," followed by the namespace, this property belongs to. Properties are always stored with their absolute key in the property store."),(0,p.kt)("p",null,"At runtime, property keys can be defined and interpreted relatively. Here is an example of an relative key of a property:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-bash"},"global/app/myapp/config/app\n")),(0,p.kt)("p",null,"Relative property keys do not start with a slash. They do not contain information about the current namespace. This information is automatically added when a property is loaded or stored."),(0,p.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,p.kt)("div",{parentName:"div",className:"admonition-heading"},(0,p.kt)("h5",{parentName:"div"},(0,p.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,p.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,p.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Why property key?")),(0,p.kt)("div",{parentName:"div",className:"admonition-content"},(0,p.kt)("ul",{parentName:"div"},(0,p.kt)("li",{parentName:"ul"},"It defines the ",(0,p.kt)("strong",{parentName:"li"},"unqiue path")," of a property in a tree structure. "),(0,p.kt)("li",{parentName:"ul"},"It makes it ",(0,p.kt)("strong",{parentName:"li"},"easier to query"),' a nested subset of properties "recursively" using path patterns.'),(0,p.kt)("li",{parentName:"ul"},"It allows to ",(0,p.kt)("strong",{parentName:"li"},"group properties"),' together under a "path-like" structure.'),(0,p.kt)("li",{parentName:"ul"},"It is also used for declaring nested read and write ",(0,p.kt)("strong",{parentName:"li"},"permissions"),"."),(0,p.kt)("li",{parentName:"ul"},"It defines the ",(0,p.kt)("strong",{parentName:"li"},"storage location")," of the property for performance optimization (for example archive is stored on a different location)")))),(0,p.kt)("h3",{id:"property-key-pattern"},"Property Key Pattern"),(0,p.kt)("p",null,'Since the key of a property is similar to a path in a tree, it is possible to use path matching techniques in order to easily find and load a nsted subset of properties "recursively" from the store. By default, PIPEFORCE uses the so called "ant-style" path matcher. This matcher uses the following rules, applied to a key:'),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},"The double asterisk ",(0,p.kt)("inlineCode",{parentName:"li"},"**")," matches any character in the key at given position."),(0,p.kt)("li",{parentName:"ul"},"The single asterisk ",(0,p.kt)("inlineCode",{parentName:"li"},"*"),' matches zero or more charachters inside a "directory" of the key (up to the next slash ',(0,p.kt)("inlineCode",{parentName:"li"},"/"),").")),(0,p.kt)("p",null,"The asterisk ",(0,p.kt)("inlineCode",{parentName:"p"},"*")," is often also called ",(0,p.kt)("strong",{parentName:"p"},"wildcard"),". A property key containing wildcards are called a ",(0,p.kt)("strong",{parentName:"p"},"key pattern")," or ",(0,p.kt)("strong",{parentName:"p"},"path pattern"),"."),(0,p.kt)("p",null,(0,p.kt)("strong",{parentName:"p"},"Example 1")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/**\n")),(0,p.kt)("p",null,"This key pattern will select all properties having a key starting with ",(0,p.kt)("inlineCode",{parentName:"p"},"global/app/myapp")," at ",(0,p.kt)("strong",{parentName:"p"},"any sublevel"),". So it will match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/config/app\nglobal/app/myapp/pipeline/mypipeline\nglobal/app/myapp/sub1/sub2/sub3/sub4/sub5/sub6/file\n")),(0,p.kt)("p",null,"But it won't mach these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/ontherapp/config/app\nglobal/something\ntmp/data\n")),(0,p.kt)("p",null,(0,p.kt)("strong",{parentName:"p"},"Example 2")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/*\n")),(0,p.kt)("p",null,"This key pattern will select all properties having a key starting with ",(0,p.kt)("inlineCode",{parentName:"p"},"global/app/myapp")," inside ",(0,p.kt)("strong",{parentName:"p"},"this level"),' (meaning inside the "directory" ',(0,p.kt)("inlineCode",{parentName:"p"},"myapp"),") but ",(0,p.kt)("strong",{parentName:"p"},"not")," at any sublevel. So it will match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/file1\nglobal/app/myapp/file2\nglobal/app/myapp/another\n")),(0,p.kt)("p",null,"But it won't match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/config/app\nglobal/app/ontherapp/config/app\ntmp/data\n")),(0,p.kt)("p",null,(0,p.kt)("strong",{parentName:"p"},"Example 3")),(0,p.kt)("p",null,"It is also possible to combine multiple wildcards inside a pattern."),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/*/data/**\n")),(0,p.kt)("p",null,"This key pattern will match any key starting with prefix ",(0,p.kt)("inlineCode",{parentName:"p"},"global/app"),", followed by any app name (without any slash), followed by ",(0,p.kt)("inlineCode",{parentName:"p"},"/data/"),", followed by any further charachters at any level. It will match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/data/user\nglobal/app/ontherapp/data/user\nglobal/app/third/data/folder/file\n")),(0,p.kt)("p",null,"But it won't match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"global/app/myapp/config/app\ntmp/data\n")),(0,p.kt)("p",null,(0,p.kt)("strong",{parentName:"p"},"Example 4")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"*\n")),(0,p.kt)("p",null,"This pattern would match any relative key at top level, but not any sub-level. So it will match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"resourceA\nresourceB\n")),(0,p.kt)("p",null,"But it won't match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"folder/file1\nfolder/folder2/file2\n")),(0,p.kt)("p",null,(0,p.kt)("strong",{parentName:"p"},"Example 5")),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"**\n")),(0,p.kt)("p",null,"This pattern will match anything at any level. So it will match these keys:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"resourceA\nresourceB\nfolder/file1\nfolder/folder2/file2\n")),(0,p.kt)("p",null,"There is no key, this pattern will not match."),(0,p.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,p.kt)("div",{parentName:"div",className:"admonition-heading"},(0,p.kt)("h5",{parentName:"div"},(0,p.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,p.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,p.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,p.kt)("div",{parentName:"div",className:"admonition-content"},(0,p.kt)("p",{parentName:"div"},"Since the catch-all pattern ",(0,p.kt)("inlineCode",{parentName:"p"},"**")," (without any additional path information) will match anything, it should be used very rarely. It can cause huge performance impacts. Because of this reason, the catch-all is not everywhere allowed. So think twice before using it."))),(0,p.kt)("h3",{id:"property-value-and-type"},"Property Value and Type"),(0,p.kt)("p",null,"The ",(0,p.kt)("inlineCode",{parentName:"p"},"value")," attribute of a property defines the ",(0,p.kt)("strong",{parentName:"p"},"payload")," of a property. Such a payload could be a JSON document or a plain text for example. It is always stored as string (text) value. Which type the text value represents, is defined by the ",(0,p.kt)("inlineCode",{parentName:"p"},"type")," attribute which could be of any supported mime type e.g. ",(0,p.kt)("inlineCode",{parentName:"p"},"application/json")," or ",(0,p.kt)("inlineCode",{parentName:"p"},"text/plain"),". The latter is the default, if no type is specified. Important mime types, used by PIPEFORCE are:"),(0,p.kt)("table",null,(0,p.kt)("thead",{parentName:"table"},(0,p.kt)("tr",{parentName:"thead"},(0,p.kt)("th",{parentName:"tr",align:null},"Mime Type"),(0,p.kt)("th",{parentName:"tr",align:null},"Description"))),(0,p.kt)("tbody",{parentName:"table"},(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/javascript")),(0,p.kt)("td",{parentName:"tr",align:null},"A JavaScript script (deprecated, use ",(0,p.kt)("inlineCode",{parentName:"td"},"text/javascript")," whenever possible).")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/json")),(0,p.kt)("td",{parentName:"tr",align:null},"JSON document.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/yaml")),(0,p.kt)("td",{parentName:"tr",align:null},"YAML document (not IANA listed).")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/xml")),(0,p.kt)("td",{parentName:"tr",align:null},"XML document as part of an application.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/html")),(0,p.kt)("td",{parentName:"tr",align:null},"HTML document.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/javascript")),(0,p.kt)("td",{parentName:"tr",align:null},"A JavaScript script.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/plain")),(0,p.kt)("td",{parentName:"tr",align:null},"Plain text document (string). This is the default, if no ",(0,p.kt)("inlineCode",{parentName:"td"},"type")," has been specified for a property.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/xml")),(0,p.kt)("td",{parentName:"tr",align:null},"XML document.")))),(0,p.kt)("p",null,"See the IANA.org websites for a full list of official mime types:\n",(0,p.kt)("a",{parentName:"p",href:"https://www.iana.org/assignments/media-types/media-types.xhtml"},"https://www.iana.org/assignments/media-types/media-types.xhtml")),(0,p.kt)("p",null,"Property types can additionally contain parameters. Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},"text/plain; charset=UTF8\n")),(0,p.kt)("p",null,"Multiple parameters are separated by a colon ",(0,p.kt)("inlineCode",{parentName:"p"},";"),". See the ",(0,p.kt)("a",{parentName:"p",href:"https://www.iana.org/assignments/media-types-parameters/media-types-parameters.xhtml"},"IANA specification")," for details. PIPEFORCE uses custom type parameters in some situations. Some examples:"),(0,p.kt)("table",null,(0,p.kt)("thead",{parentName:"table"},(0,p.kt)("tr",{parentName:"thead"},(0,p.kt)("th",{parentName:"tr",align:null},"Type"),(0,p.kt)("th",{parentName:"tr",align:null},"Description"))),(0,p.kt)("tbody",{parentName:"table"},(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/plain; encoding=base64")),(0,p.kt)("td",{parentName:"tr",align:null},"Indicates, that the property value is a base64 encoded string.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/yaml; type=pipeline")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is a pipeline script, written in YAML.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/xml; type=workflow")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is an XML document defining a workflow (for example BPMN).")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/json; type=form")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is a JSON document defining a PIPEFORCE form config.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/json; type=list")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is a JSON document defining a PIPEFORCE list config.")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"application/json; type=schema")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is a JSON document defining a JSON schema which complies with the definition from ",(0,p.kt)("a",{parentName:"td",href:"https://json-schema.org/"},"json-schema.org"),".")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/plain; type=template; format=freemarker")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is a ",(0,p.kt)("a",{parentName:"td",href:"https://freemarker.apache.org/"},"FreeMarker")," template .")),(0,p.kt)("tr",{parentName:"tbody"},(0,p.kt)("td",{parentName:"tr",align:null},(0,p.kt)("inlineCode",{parentName:"td"},"text/plain; type=template; format=velocity")),(0,p.kt)("td",{parentName:"tr",align:null},"The property value is a ",(0,p.kt)("a",{parentName:"td",href:"https://velocity.apache.org/"},"Velocity")," template .")))),(0,p.kt)("h3",{id:"binary-value"},"Binary Value"),(0,p.kt)("p",null,"The ",(0,p.kt)("inlineCode",{parentName:"p"},"value")," attribute contains always values of type ",(0,p.kt)("inlineCode",{parentName:"p"},"string"),". In order to store binary data there, it must be ",(0,p.kt)("inlineCode",{parentName:"p"},"base64")," encoded before it gets persisted. In this case, the property must be marked as a base64 value. This is done in the ",(0,p.kt)("inlineCode",{parentName:"p"},"type")," attribute using the mime type parameter ",(0,p.kt)("inlineCode",{parentName:"p"},"encoding=base64"),". Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'value: "<some base64 encoded value>"\ntype: "application/pdf;encoding=base64"\n')),(0,p.kt)("p",null,'In this case the property can be automatically converted back into a "binary" file when loaded.'),(0,p.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,p.kt)("div",{parentName:"div",className:"admonition-heading"},(0,p.kt)("h5",{parentName:"div"},(0,p.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,p.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,p.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,p.kt)("div",{parentName:"div",className:"admonition-content"},(0,p.kt)("p",{parentName:"div"},"The base64 encoding approach is only meant for small files, not bigger than a few KB and not that many. In case you want to store more and bigger files, consider storing them as ",(0,p.kt)("strong",{parentName:"p"},"property attachments")," instead, since they do have a chunked storage handling concept and can store a huge amount of binary data more effectively."))),(0,p.kt)("h2",{id:"create-a-property"},"Create a Property"),(0,p.kt)("p",null,"To create a new property in the property store, you need to define a property schema first using the command ",(0,p.kt)("a",{parentName:"p",href:"../api/commands#propertyschemaput-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.schema.put")),". Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - property.schema.put:\n      key: "global/app/myapp/data/mydata"\n      type: "application/json"\n')),(0,p.kt)("p",null,"This schema defines the base envelope data for the new property like its ",(0,p.kt)("inlineCode",{parentName:"p"},"key"),", ",(0,p.kt)("inlineCode",{parentName:"p"},"uuid")," and ",(0,p.kt)("inlineCode",{parentName:"p"},"type"),". After the schema has been created, the property payload can be added and edited."),(0,p.kt)("p",null,"To simplify these steps, you can create the schema and add the payload value in one single step:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - property.schema.put:\n      key: "global/app/myapp/data/mydata"\n      type: "application/json"\n      value: {"hello": "world"}\n')),(0,p.kt)("h3",{id:"property-created-event"},"Property created event"),(0,p.kt)("p",null,"Whenever you create a new a property, an event with key ",(0,p.kt)("inlineCode",{parentName:"p"},"property.created")," is fired with the created property stored in ",(0,p.kt)("inlineCode",{parentName:"p"},"target")," of the event object. This way you can listen in your pipelines for properties created newly. See the ",(0,p.kt)("a",{parentName:"p",href:"../api/events#propertycreated-v1"},"reference documentation")," for details. Here is an example how to listen to such an event in a ",(0,p.kt)("strong",{parentName:"p"},"persisted")," pipeline:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - event.listen:\n      key: "property.created"\n      filter: "#{body.target.key.contains(\'global/app/myapp/data/mydata\')}"\n\n  # Do something here\n')),(0,p.kt)("p",null,"This persisted pipeline gets automatically executed whever a new property with a key containing ",(0,p.kt)("inlineCode",{parentName:"p"},"global/app/myapp/data/mydata")," has been created."),(0,p.kt)("h2",{id:"update-a-property"},"Update a Property"),(0,p.kt)("p",null,"To change the ",(0,p.kt)("strong",{parentName:"p"},"value")," of the property, you can use the command ",(0,p.kt)("a",{parentName:"p",href:"../api/commands#propertyput-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.put")),". The property must already exist beforehand. Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n - property.put: \n     key: "global/app/myapp/data/mydata"\n     value: {"new": "value"}\n')),(0,p.kt)("p",null,"In order to change the envelope data (attributes) of a property, you need to use the  ",(0,p.kt)("a",{parentName:"p",href:"../api/commands#propertyput-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.schema.put"))," command:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n - property.schema.put: \n     key: "global/app/myapp/data/mydata"\n     timeToLive: 5\n')),(0,p.kt)("p",null,"If you would like to change the key of an existing property, you can use the ",(0,p.kt)("a",{parentName:"p",href:"../api/commands#propertymove-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.move"))," command:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n - property.move: \n     key: "global/app/myapp/data/mydata"\n     to: "global/app/myapp/data/newlocation"\n')),(0,p.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,p.kt)("div",{parentName:"div",className:"admonition-heading"},(0,p.kt)("h5",{parentName:"div"},(0,p.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,p.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,p.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,p.kt)("div",{parentName:"div",className:"admonition-content"},(0,p.kt)("p",{parentName:"div"},(0,p.kt)("strong",{parentName:"p"},"Why are there two different commands to create a property and set its value?")),(0,p.kt)("p",{parentName:"div"},"Because there are two different security levels with permissions. Those users who are able to change the value of a property with ",(0,p.kt)("inlineCode",{parentName:"p"},"property.put"),", not always have the permission to create a new property or changing its other attributes using ",(0,p.kt)("inlineCode",{parentName:"p"},"property.schema.put"),". Having two commands allows it to differentiate in a pipeline what a user can do, since in PIPEFORCE any command can have assigned different permissions."))),(0,p.kt)("h3",{id:"property-changed-event"},"Property changed event"),(0,p.kt)("p",null,"Whenever you update a property value or one of its other attributes, an event with key ",(0,p.kt)("inlineCode",{parentName:"p"},"property.updated")," is fired with the origin property stored in ",(0,p.kt)("inlineCode",{parentName:"p"},"origin")," of the event object and the final version of the property in ",(0,p.kt)("inlineCode",{parentName:"p"},"target"),". This way you can listen in your pipelines for property changes. See the ",(0,p.kt)("a",{parentName:"p",href:"../api/events#propertyupdated"},"reference documentation")," for details. Here is an example how to listen to such an event in a ",(0,p.kt)("strong",{parentName:"p"},"persisted")," pipeline:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - event.listen:\n      key: "property.updated"\n      filter: "#{body.origin.key.contains(\'global/app/myapp/data/mydata\')}"\n\n  # Do something here\n')),(0,p.kt)("h3",{id:"property-moved-event"},"Property moved event"),(0,p.kt)("p",null,"Whenever you move a property by changing its origin key, an event with key ",(0,p.kt)("inlineCode",{parentName:"p"},"property.moved")," is fired with the origin key property stored in ",(0,p.kt)("inlineCode",{parentName:"p"},"origin")," of the event object and the final key of the property in ",(0,p.kt)("inlineCode",{parentName:"p"},"target"),". This way you can listen in your pipelines for property movements. See the ",(0,p.kt)("a",{parentName:"p",href:"../api/events#propertymoved"},"reference documentation")," for details. Here is an example how to listen to such an event in a ",(0,p.kt)("strong",{parentName:"p"},"persisted")," pipeline:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - event.listen:\n      key: "property.moved"\n      filter: "#{body.origin.contains(\'global/app/myapp/data/mydata\')}"\n\n  # Do something here\n')),(0,p.kt)("h2",{id:"delete-a-property"},"Delete a Property"),(0,p.kt)("p",null,"In order to delete a property from the property store, you can use the command ",(0,p.kt)("inlineCode",{parentName:"p"},"property.schema.delete"),", which deletes the property value and all metadata that belongs to this property. Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n - property.schema.delete:\n     key: "global/app/myapp/data/mydata"\n')),(0,p.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,p.kt)("div",{parentName:"div",className:"admonition-heading"},(0,p.kt)("h5",{parentName:"div"},(0,p.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,p.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,p.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,p.kt)("div",{parentName:"div",className:"admonition-content"},(0,p.kt)("p",{parentName:"div"},"Be careful using this command since once deleted, the property and its value cannot be restored!"))),(0,p.kt)("p",null,"You can also delete multiple properties at once using a pattern. Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n - property.schema.delete:\n     pattern: "global/app/myapp/**"\n')),(0,p.kt)("p",null,"This example will delete all properties of the app ",(0,p.kt)("inlineCode",{parentName:"p"},"myapp")," recursively."),(0,p.kt)("h3",{id:"property-deleted-event"},"Property deleted event"),(0,p.kt)("p",null,"Whenever you delete a property, an event with key ",(0,p.kt)("inlineCode",{parentName:"p"},"property.deleted")," is fired with the origin property stored in ",(0,p.kt)("inlineCode",{parentName:"p"},"origin")," of the event object. This way you can listen in your pipelines for property deletions. See the ",(0,p.kt)("a",{parentName:"p",href:"../api/events#propertydeleted"},"reference documentation")," for details. Here is an example how to listen to such an event in a ",(0,p.kt)("strong",{parentName:"p"},"persisted")," pipeline:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - event.listen:\n      key: "property.deleted"\n      filter: "#{body.origin.key.contains(\'global/app/myapp/data/mydata\')}"\n\n  # Do something here\n')),(0,p.kt)("h2",{id:"loading-properties"},"Loading Properties"),(0,p.kt)("p",null,"If you want to query for property data, you have multiple options in PIPEFORCE."),(0,p.kt)("h3",{id:"listing-properties"},"Listing properties"),(0,p.kt)("p",null,"One of the simplest approaches to query for multiple properties is by using the command  ",(0,p.kt)("a",{parentName:"p",href:"../api/commands#propertylist-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.list")),". Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},"pipeline:\n  - property.list:\n      pattern: global/app/myapp/pipeline/helloworld\n")),(0,p.kt)("p",null,"This command will return a result similar to the result shown below, which describes all important attributes of the property:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key": "/pipeforce/enterprise/global/app/myapp/pipeline/helloworld",\n  "uuid": "529a38e7-9188-4135-b87b-3d890f6764f3",\n  "value": "pipeline:\\n  - log:        \\n      message: \\"Hello World\\"",\n  "defaultValue": null,\n  "type": "application/yaml;type=pipeline",\n  "created": 1613397114448,\n  "updated": null,\n  "timeToLive": null,\n}\n')),(0,p.kt)("p",null,"You can also use a key pattern in order to load multiple properties matching this key pattern. This example will load all properties inside the ",(0,p.kt)("inlineCode",{parentName:"p"},"pipeline")," folder:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},"pipeline:\n  - property.list:\n      pattern: global/app/myapp/**\n")),(0,p.kt)("p",null,'This will return "recursively" all properties below the path ',(0,p.kt)("inlineCode",{parentName:"p"},"global/app/myapp/"),". The properties attributes including the value will be returned. "),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},'[\n  {\n    "key": "...",\n    "uuid": "...",\n    "value": "...",\n    "defaultValue": null,\n    "type": "...",\n    "created": 123,\n    "updated": null,\n    "timeToLive": null,\n  },\n  {\n    "key": "...",\n    "uuid": "...",\n    "value": "...",\n    "defaultValue": null,\n    "type": "...",\n    "created": 123,\n    "updated": null,\n    "timeToLive": null,\n  }\n]\n')),(0,p.kt)("h3",{id:"getting-property-value"},"Getting property value"),(0,p.kt)("p",null,"In case you would like to load only the value (payload) of a property but not its metadata, you can use the command ",(0,p.kt)("a",{parentName:"p",href:"../api/commands#propertyvalueget-v1"},(0,p.kt)("inlineCode",{parentName:"a"},"property.value.get")),". Example:"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - property.value.get:\n      key: "global/app/myapp/pipeline/helloworld"\n')),(0,p.kt)("h3",{id:"advanced-querying"},"Advanced Querying"),(0,p.kt)("p",null,"In case the base commands for loading properties are not sufficient for your case, you can use ",(0,p.kt)("a",{parentName:"p",href:"guides/propertystore/advanced-querying"},"Advanced Querying"),"."))}u.isMDXComponent=!0}}]);